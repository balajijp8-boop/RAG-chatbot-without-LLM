<!DOCTYPE html>
<html>
<head>
<title>AI Assistant</title>
<style>
body { font-family: Arial; background: #f4f4f4; }
.chat { max-width: 600px; margin: auto; background: white; padding: 10px; }
.msg { margin: 8px 0; }
.user { text-align: right; color: blue; }
.bot { text-align: left; color: green; }
input { width: 80%; padding: 8px; }
button { padding: 8px; }
</style>
</head>

<body>
<div class="chat">
<h2>ðŸ¤– AI Assistant</h2>

<form id="uploadForm">
<input type="file" id="file" />
<button type="submit">Upload</button>
</form>

<hr>

<div id="chat"></div>

<input id="q" placeholder="Ask something..." />
<button onclick="ask()">Send</button>
</div>

<script>
const chat = document.getElementById("chat");

function addMsg(text, cls) {
    const d = document.createElement("div");
    d.className = "msg " + cls;
    d.innerText = text;
    chat.appendChild(d);
}

async function ask() {
    const q = document.getElementById("q").value;
    addMsg("You: " + q, "user");

    const res = await fetch("/ask?q=" + encodeURIComponent(q), {method: "POST"});
    const data = await res.json();

    addMsg("Bot: " + data.answer, "bot");
    document.getElementById("q").value = "";
}

document.getElementById("uploadForm").onsubmit = async (e) => {
    e.preventDefault();
    const f = document.getElementById("file").files[0];
    const form = new FormData();
    form.append("file", f);

    await fetch("/upload", {method: "POST", body: form});
    alert("Document uploaded!");
};
</script>
</body>
</html>
